## Basics

- **IAM (Identity and Access Management)** is used to securely control access to AWS resources.
    
- Entities in IAM:
    
    - **Users** → Represent individual identities.
        
    - **Groups** → Collection of users with shared permissions.
        
    - **Policies** → Define access rules (JSON documents).
        
    - **Roles** → Grant temporary access to AWS resources.
        

---

## AWS CLI Setup

```bash
aws configure
```

- Configure access credentials (`AWS Access Key`, `Secret Key`, `Region`, `Output format`).
    
- Can be used multiple times to switch/update profiles.
    

```bash
aws sso login --profile my-profile
aws sso login --profile asad
```

- For logging in via AWS SSO with specific profiles.
    

---

## User Management

### List all users

```bash
aws iam list-users
```

### Create a user

```bash
aws iam create-user --user-name dev-asad
```

---

## Group Management

### Create a group

```bash
aws iam create-group --group-name developers
```

### Attach policy to group

```bash
aws iam attach-group-policy \
  --policy-arn arn:aws:iam::aws:policy/AdministratorAccess \
  --group-name developers
```

### Add user to group

```bash
aws iam add-user-to-group \
  --user-name dev-asad \
  --group-name developers
```

### Detach policy from group

```bash
aws iam detach-group-policy \
  --group-name developers \
  --policy-arn arn:aws:iam::aws:policy/AdministratorAccess
```

---

## Policies

### Create a policy

- Write policy in JSON file (`s3-bucket-access.json`).
    

```bash
aws iam create-policy \
  --policy-name testS3BucketAccessPolicy \
  --policy-document file://s3-bucket-access.json
```

### Attach policy to group

```bash
aws iam attach-group-policy \
  --policy-arn arn:aws:iam::<account-id>:policy/testS3BucketAccessPolicy \
  --group-name developers
```

### Create new policy version (when updating JSON)

```bash
aws iam create-policy-version \
  --policy-arn arn:aws:iam::<account-id>:policy/testS3BucketAccessPolicy \
  --policy-document file://s3-bucket-access.json
```

---

## Observations / Learnings

1. **Users are identities**, but permissions are not attached directly to users in best practice. Instead:
    
    - Put users in **groups**.
        
    - Attach **policies** to groups.
        
2. **Policies** are versioned → every time you update, a new version is created.
    
3. **Detaching/attaching policies** lets you fine-tune access control without deleting resources.
    
4. **SSO profiles** simplify switching between environments.
    
